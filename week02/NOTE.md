在实现人类与机器无障碍交流之前，我们还是要比较严谨的形式语言来交流

语言按语法分类

* 非形式语言
  * 中文 英文
* 形式语言（乔姆斯基谱系 50年代）
  0型 无限制文法：无限制并不是非形式，有严格定义
  1型 上下文相关文法：和上下文相关，一个词放在不同位置有不同的意思，对引擎实现不友好
  2型 上下文无关文法：和上下文无关，一个词就固定时那个意思，现在大部分计算机语言在主体上是2型文法，做编译器没那么难受
  3型 正则文法：能用正则表达式解析的文法，对表达能力的限制比较强，不考虑

乔姆斯基谱系仍是指引我们如何定义计算机语言的体系

JavaScript语法不是2型，它某些点上是违反 2型原则，但JavaScript主体大部分是遵循2型；this属于上下文无关，它的多变在于语义上的多变，语法上是同一个东；a.this和this.a是两个意思，这种情况属于上下文相关

现代语言采用折中的办法，把所有文法分成词法和语法两部分。词法用正则进行粗略的处理变成单个词，再把这些词作为输入流进行语法分析，目前主流语言都是采用这种方式。极少数语言是一遍出，解释一遍就出来结果

要理解形式语言，还要知道产生式，产生式有很多种写法，最基础的写法BNF

BNF，Backus–Naur form，巴科斯-诺尔范式

* 用尖括号括起来的名称来表示语法结构名
* 语法结构分成基础结构和需要用其他语法结构定义的复合结构
  * 基础结构称终结符
  * 复合结构称非终结符
* 引号和中间的字符表示终结符
* 可以有括号
* `*`表示重复多次
* `|`表示或
* `+`表示至少一次



用BNF定义一门语言，只能由“a“ ”b“ 两个基础字符来组成

用BNF定义一个加法表达式语法

用BNF定义四则运算符表达式和逻辑运算符表达式

从上面例子可以看出BNF可以很方便的定义各种表达式和优先级

只要是形式语言，都能用BNF来描述



通过产生式理解乔姆斯基谱系

0型 无限制文法 `?::=?`，等号两边终结符和非终结符数无限制，`<a> <b> ::= "c" <d>`，`<a> <b> <c> ::= "d"`

1型 上下文相关文法 `?<A>?::=?<B>?`，两边问号代表上下文，在某个上下文下，B被理解成A，`<a> <b> <c> ::= <a> "x" <c>`，`"a" <b> "c" ::= "a" "x" "c"`，上下文不动

2型 上下文无关文法 `<A>::=?`，问号是某种终结符或非终结符，不管什么情况下它的意思都是为A

3型 正则文法 只允许左递归 表达式右边如果有递归引用自身那么一定在最左边

* `<A>::=<A>?`
* 不能是`<A>::=?<A>`

把右递归变左递归，然后能用正则文法解析

用正则表达式重写BNF四则运算表达式

用正则表达式分析的过程叫做词法分析，然后将产生式生成语法树，剪枝，抽象语法树



查看JavaScript的全部语法和产生式，ECMA-262 PDF 章节A Grammar Summary A.1 — A.5

Lexical Grammar 词法

Scripts and Modules 脚本和模块 最顶层的结构 A.5

Statement 语句



现代语言的特例

* C++中，*可能表示乘号或者指针，具体是哪个，取决于星号前面的标识符是否被声明为类型（标识符是否被声明属于语义范畴，语法和语义相关，属于非形式语言，一些特殊的语法可以被特殊技巧处理掉）
* VB中，<可能是小于号，也可能是XML直接量的开始，取决于当前位置是否可以接受XML直接量，JavaScript的JSX语法也有这个。（属于1型文法）
* Python中，行首的tab符和空格会根据上一行的行首空白以一定规则被处理成虚拟终结符indent或者dedent
* JavaScript中，/可能是除号，也可能是正则表达式开头，处理方式类似于VB，字符串模板中也需要特殊处理}，还有自动插入分号规则

练习：尽可能寻找你知道的计算机语言，尝试把它们分类（看它们语法里依次有没有属于1型、0型的case）



图灵完备性

* 命令式——图灵机
  * goto
  * if和while
* 声明式——lambda
  * 递归

跟图灵机等效的就具有图灵完备性

凡是可计算的东西，都能计算出来，就是图灵机

图灵机没有办法计算出另一台图灵机是否停机（图灵停机问题）

任何一门计算机语言都必须具有图灵完备性，符合上面三种中的一种



动态与静态

* 动态：
  * 在用户的设备/在线服务器上
  * 产品实际运行时
  * Runtime
* 静态：
  * 在程序员的设备上
  * 产品开发时
  * Compiletime

语言都有静态和动态的部分，静态的部分占比越多，由这个语言所构建的程序越稳定，适合大型应用开发，静态特性里面最重要的功能，类型检查

类型系统

动态类型系统与静态类型系统

JavaScript有静态类型系统

强类型与弱类型（是否发生了隐式类型转换）

* String + Number 

* String == Boolean

JavaScript的上面两个例子，都发生了隐式类型转换，所以它属于弱类型，C++、TS也属于弱类型

复合类型

* 结构体
* 函数签名

一个例子

{

​	a: T1,

​	b: T2

}

(T1, T2) => T3

子类型

* 逆变/协变

一个例子

凡是能用`Array<Parent>`的地方，都能用`Array<Child>`，这叫协变，`Array<Child>`这种类型自然而然地继承了`Array<Parent>`

凡是能用`Function<Child>`的地方，都能用`Function<Parent>`，这叫逆变



一般命令式编程语言

有5层结构：

* Atom 原子，最小的结构
  * Identifier
  * Literal 字面量 如3.14、“abc”
* Expression 表达式
  * Atom
  * Operator
  * Punctuator
* Statement 语句
  * Expression
  * Keyword
  * Punctuator
* Structure 结构化
  * Function
  * Class
  * Process
  * Namespace
  * ......
* Program 程序级
  * Program
  * Module
  * Package
  * Library